\section{Dualit\'e II: interprétation, analyse postoptimale}

\begin{enumerate}

  \item On considère le problème diététique suivant:
    Il s'agit d'acheter à un coût minimum des fruits, des légumes et
    de la viande afin d'obtenir suffisamment de vitamines A et B.
    Pour une alimentation saine, on considère qu'il faut consommer
    11 unités de vitamines A et 4 unités de vitamines B. Les valeurs
    nutritives des aliments (par unité de poids) sont données dans
    le tableau ci-dessous: \\

    \begin{tabular}{|c|c|c|c|}
      \hline
      & Légumes & Fruits & Viande \\
      \hline
      Vitamine A & 1 & 5 & 1 \\
      \hline
      Vitamine B & 2 & 1 & 1 \\
      \hline
    \end{tabular}\\

    Les coûts par unité de poids des aliments sont de 3 (légumes),
    2 (fruits) et 10 (viande). Modélisez ce problème et résolvez-le.

    On considère ensuite le problème de l'entreprise pharmaceutique qui synthétise
    artificiellement de la vitamine A et B et qui vend la vitamine pure au diététicien.  L'entreprise cherche à déterminer les prix
    de vente des vitamines qui lui assurent d'emporter tout le marché tout en maximisant son profit. Modélisez ce problème
    et résolvez-le. Laquelle des deux vitamines est la plus chère?

    Contre toute attente, l'entreprise décide de mettre de la vitamine A et B sur le marché à des prix de 1 et 0.5. Comment le
    diététicien compose-t-il le mélange?

    \begin{solution}
      Soient $x_A, x_B$ et $x_C$ les quantités respectives
      de légumes, fruits et viande.
      Le primal est
      \begin{align*}
        \min 3x_A + 2x_B + 10x_C\\
        x_A + 5x_B + x_C & \geq 11\\
        2x_A + x_B + x_C & \geq 4\\
        x_A, x_B, x_C & \geq 0.
      \end{align*}

      Soient $y_{1}$ et $y_{2}$ le coût de produire respectivement
      de la vitamine $A$ et $B$.
      Le dual est
      \begin{align*}
        \max 11y_{1} + 4y_{2}\\
        y_{1} + 2y_{2} & \leq 3\\
        5y_{1} + y_{2}  & \leq 2\\
        y_{1} + y_{2} & \leq 10\\
        y & \geq 0.
      \end{align*}
      En effectuant l'algorithme du simplexe pour le dual,
      on obtient $y^{*} = (\frac{1}{9},\frac{13}{9})$.
      Par la relation d'exclusion,
      il faut nécessairement que $Ax = b$ car $y > 0$
      et que $x_C = 0$ car $y_1 + y_2 < 10$.
      On obtient $\xopt = A^{-1}b = (1,2,0)$.
      En conclusion, la vitamine $B$ est la plus chère.

      Si l'entreprise décide de mettre la vitamine A et B sur le
      marché à des prix de 1 et 0.5,
      le diététicien a le choix entre
      acheter des fruits, légumes ou viande pour leurs vitamines
      ou acheter des vitamines de l'entreprise directement.
      Soit $x_D$ (resp. $x_E$) la quantité de vitamines A (resp. B)
      achetée par le diététicien,
      le problème primal devient alors
      \begin{align*}
        \min 3x_A + 2x_B + 10x_C + x_D + \frac{1}{2}x_E\\
        x_A + 5x_B + x_C + x_D & \geq 11\\
        2x_A + x_B + x_C + x_E & \geq 4\\
        x_A, x_B, x_C, x_D, x_E & \geq 0.
      \end{align*}
    \end{solution}

  \item On considère le problème suivant:

    $
    \begin{array}{llcr}
      \maxi & x_1+2x_2+ x_3+x_4\\
      & 2x_1+x_2+5x_3+x_4 & \leq & 8 + \delta\\
      & 2x_1+ 2x_2+ 4x_4 & \leq & 12\\
      & 3x_1+ x_2+ 2x_3 & \leq & 18\\
      & x_1, x_2, x_3, x_4 & \geq & 0
    \end{array}
    $

    La solution associée à la base $(x_2, x_3, x_7)$ est optimale pour $\delta = 0$ ($x_7$ est la variable d'écart de la 3ème contrainte); la solution
    correspondante est donnée par $(x_1, x_2, x_3, x_4)=(0, 6, 0.4, 0)$. Pour quelles valeurs de
    $\delta$ la base reste-t-elle optimale?



    \begin{solution}
      Le problème sous forme standard est
      \begin{align*}
        -\min -x_1 - 2x_2 - x_3 - x_4\\
        2x_1+x_2+5x_3+x_4 + x_5 & = 8 + \delta\\
        2x_1+ 2x_2+ 4x_4 + x_6 & = 12\\
        3x_1+ x_2+ 2x_3 + x_7 & = 18\\
        x_1, x_2, x_3, x_4, x_5, x_6, x_7 & \geq 0.
      \end{align*}
      Il peut être réécrit sous la forme
      \begin{align*}
        -\min
        \begin{pmatrix}
          c_B^T & c_N^T
        \end{pmatrix}
        x\\
        \begin{pmatrix}
          B & N
        \end{pmatrix}
        x & = b\\
        x & \geq 0
      \end{align*}
      où
      \begin{align*}
        c_B & =
        \begin{pmatrix}
          -2\\-1\\0
        \end{pmatrix}
        & c_N & =
        \begin{pmatrix}
          -1\\-1\\0\\0
        \end{pmatrix}
        & x & =
        \begin{pmatrix}
          x_2\\x_3\\x_7\\x_1\\x_4\\x_5\\x_6
        \end{pmatrix}\\
        B & =
        \begin{pmatrix}
          1 & 5 & 0\\
          2 & 0 & 0\\
          1 & 2 & 1
        \end{pmatrix}
        & N & =
        \begin{pmatrix}
          2 & 1 & 1 & 0\\
          2 & 4 & 0 & 1\\
          3 & 2 & 0 & 0
        \end{pmatrix}
        & b & =
        \begin{pmatrix}
          8 + \delta\\12\\18
        \end{pmatrix}.
      \end{align*}
      Comme $A$ est inversible, on a
      \begin{align*}
        -\min
        \begin{pmatrix}
          c_B^T & c_N^T
        \end{pmatrix}
        x\\
        \begin{pmatrix}
          I & B^{-1}N
        \end{pmatrix}
        x & = B^{-1}b\\
        x & \geq 0
      \end{align*}
      puis
      \begin{align*}
        -\min
        \begin{pmatrix}
          0 & c_N^T - c_B^TB^{-1}N
        \end{pmatrix}
        x\\
        \begin{pmatrix}
          I & B^{-1}N
        \end{pmatrix}
        x & = B^{-1}b\\
        x & \geq 0.
      \end{align*}
      On voit donc qu'une base est admissible lorsque $B^{-1}b \geq 0$
      et optimale si les coût réduits
      $\tilde{c}^T = c_{N}^{T} - c_{B}^{T}B^{-1}N \geq 0$.
      Or, ici, $\tilde{c}^T = \frac{1}{10}
      \begin{pmatrix}
        12 & 28 & 2 & 9
      \end{pmatrix}$ est positif indépendamment de $\delta$
      et $B^{-1}b = \frac{1}{5}
      \begin{pmatrix}
        6 & \frac{\delta +2}{5} & \frac{56 - 2\delta}{5}
      \end{pmatrix}^{T}$
      est positif si et seulement si $-2 \leq \delta \leq 28$.
    \end{solution}

  \item On considère le problème suivant:

    $
    \begin{array}{llcr}
      \maxi & 3x_1+13x_2+13x_3\\
      & x_1+x_2 & \leq & 7\\
      & x_1+ 3x_2+ 2x_3 & \leq & 15\\
      &  2x_2+ 3x_3 & \leq & 9\\
      & x_1, x_2, x_3 & \geq & 0
    \end{array}
    $

    Une base optimale est donnée par $(x_1, x_2, x_3)$. Pour cette base on obtient

    $$
    B^{-1}=
    \left[
      \begin{array}{ccc}
        5/2 & -3/2 & 1\\
        -3/2 & 3/2 & -1\\
        1 & -1 & 1
      \end{array}
    \right]
    $$

    \begin{enumerate}
      \item Donnez une solution du primal et une solution du dual.
      \item Comment évolue l'objectif optimal lorsque le terme de droite de la deuxième contrainte décroît?
      \item De combien d'unités le terme de droite de la première contrainte peut-il varier sans modifier la base optimale?
      \item De combien d'unités le coefficient objectif associé à $x_1$ peut-il varier sans modifier la base
        optimale?
      \item La base resterait-elle optimale si on ajoutait une nouvelle variable $x_4$ de coefficient objectif $5$ et de vecteur de contrainte $(2, -1, 5)$?
      \item Trouvez une solution du problème obtenu en ajoutant la contrainte $x_1-x_2+2x_3 \leq 10$.

    \end{enumerate}


    \begin{solution}
      \begin{enumerate}
        \item
          Le dual vaut
          \begin{align*}
            \min b^Ty\\
            B^Ty & \geq c\\
            y & \geq 0
          \end{align*}
          La solution du primal est $x_B = B^{-1}b = (4,3,1)^{T}$.
          Le vecteur est bien positif et il vérifie bien les contraintes.
          Comme aucun $x$ n'est nul, par la relation d'exclusion,
          $B^T y = c$.
          La solution du dual est donc $y^{*} = (B^T)^{-1}c = (1,2,3)^{T}$.
          La valeur de la fonction coût est identique
          pour le primal et le dual.
        \item Le coût de la fonction devient plus petit.
          En effet, la fonction objectif du dual est $b^Ty$ donc si
          on passe de 15 à $15 - \delta$, on passe de $z^*$ à
          $z^* - y_2^* \delta = z^* - 2\delta$.
      \end{enumerate}
    \end{solution}

  \item Les joueurs $A$ et $B$ choisissent indépendamment l'un de l'autre un nombre entre 1 et 100. L'issue du jeu est nulle si les
    deux joueurs choisissent le même nombre. Sinon, le joueur qui a choisi le plus petit nombre gagne; sauf si ce nombre est d'une unité
    inférieur à celui choisi par l'autre joueur, auquel cas l'autre joueur gagne. Montrez comment la recherche de la stratégie aléatoire
    optimale peut-être exprimée comme un problème d'optimisation linéaire.


    \begin{solution}
      \nosolution
    \end{solution}

  \item Une firme textile produit trois biens en quantités $x_1, x_2, x_3$. Le planning de production pour le prochain mois satisfait
    les contraintes suivantes

    $
    \begin{array}{llcr}
      & x_1+2x_2 +2x_3 & \leq & 12\\
      & 2x_1+4x_2 +x_3 & \leq & 10\\
      & x_1, x_2, x_3 & \geq & 0
    \end{array}
    $

    La première contrainte résulte de limitations techniques. La deuxième contrainte exprime une limitation due à la quantité de coton
    disponible sur le marché. Les profits associés aux produits $x_1, x_2, x_3$
    sont de 2, 3 et 3. Comment évolue le profit  lorsque la quantité de coton disponible passe de 10 à $10+ \epsilon$ pour
    $\epsilon >0$? et lorsque elle passe de 10 à 12? Remplacez la deuxième
    contrainte par $2x_1+4x_2 +x_3 \leq c$ et utilisez un argument géométrique pour trouver l'évolution du profit en fonction de $c$.







    \begin{solution}
      \begin{itemize}
      	\item Le problème primal est 
	\begin{align*}
	 \max 2x_1 + 3x_2 + 3x_3\\
            x_1 + 2x_2 + 2x_3& \leq 12\\
           2 x_1 + 4x_2 + x_3 & \leq 10\\
            x_1\text{, }x_2 \text{, }x_3 & \geq 0\\
	\end{align*}
	
	ou encore 
	\begin{align*}
	 - \min -2x_1 - 3x_2 - 3x_3\\
            x_1 + 2x_2 + 2x_3& \leq 12\\
            2x_1 + 4x_2 + x_3 & \leq 10\\
            x_1\text{, }x_2 \text{, }x_3 & \geq 0\text{.}\\
	\end{align*}
	
	Le dual de ce problème est donc
      	\begin{align*}
            - \max 12y_1 + 10y_2\\
            y_1 + 2y_2 & \leq -2\\
            2y_1 + 4y_2 & \leq -3\\
            2y_1 + y_2 & \leq -3\\
            y_1\text{, }y_2 & \leq 0\text{.}\\
          \end{align*}
          
          On peut résoudre celui-ci géométriquement et on trouve que la solution optimale est en $(\frac{-4}{3}$, $\frac{-1}{3}$). Lorsque la quantité de coton disponible passe de $10$ à $10+\epsilon$, la fonction objectif change donc de $-\epsilon\text{.}y_2$ c'est-à-dire qu'elle augmente de $\frac{\epsilon}{3}$. En particulier, lorsque $\epsilon = 2$, elle augmente de $\frac{2}{3}$.
          
          \item Si $c < 0$, il n'y a pas de solution vu que $x_1\text{, }x_2 \text{, }x_3 \geq 0$.
          Si $0 \leq c < 6$, la solution se situe en $(0, -3)$ ce qui donne comme coût optimal $3c$.
          Si $c = 6$, tous les points du segment de la droite $2y_1+y_2 = -3$ entre $(-4/3,-1/3)$ et $(0,-3)$ sont des solutions optimales et ils donnent tous $18$ comme coût optimal (qui correspond bien à $3c$ aussi).
          Si $6 < c$, le point $(-4/3,-1/3)$ est optimal donc le coût optimal est de $12\frac{4}{3}+c\frac{1}{3} = 16+\frac{c}{3}$.
             
     \end{itemize}
   \end{solution}

  \item  Une université belge dispose d'au plus 5000 places pour des étudiants. Elle recrute des étudiants belges et
    des étudiants étrangers. L'université compte 440 professeurs. L'encadrement est d'au moins un professeur pour 12 belges et d'un professeur pour 10
    étrangers. L'université possède 2800 places dans des kots universitaires, elle garantit  qu'au moins 40 \% des étudiants belges et 80 \% des étudiants
    étrangers trouveront place  dans un kot universitaire. L'université reçoit des subsides de 2000 EUR par étudiant belge et un minerval de 3000 EUR par
    étudiant étranger. On suppose que l'université cherche à maximiser sont profit.  On vous demande de répondre aux questions suivantes.

    \begin{enumerate}
      \item  Formulez le problème de la maximisation du profit comme un problème d'optimisation linéaire. Résolvez le problème.

      \item Trouvez la formulation  duale de ce problème. Soit $y_*$ une solution optimale du dual. Proposez une interprétation pour les
        différentes composantes de
        $y_*$.

      \item   L'université a-t-elle avantage a recruter des professeurs supplémentaires pour 10000 EUR par professeur et par an?

      \item L'université engage des professeurs supplémentaires à 8000 EUR par an. Combien de professeurs a-t-elle avantage \`a engager?

    \end{enumerate}


    \begin{solution}
      \nosolution
    \end{solution}

  \item  Une firme d\'esire produire un nouvel alliage comportant au minimum
    30 $\%$ de cuivre et 20 $\%$ de zinc. La firme dispose des alliages suivants:

    \begin{tabular}{|c|c|c|c|c|}
      \hline
      alliage &  $\%$ de cuivre & $\%$ de zinc & $\%$ autres m\'etaux & prix (Euro/kilo) \\
      \hline
      1 & 66 & 22 & 12 & 33 \\
      \hline
      2 & 20 & 10 & 70 & 20 \\
      \hline
      3 & 45 & 45 & 10 & 30 \\
      \hline
      4 & 20 & 50  & 30 & 40\\
      \hline
      5 & 0 & 0 & 100 & 0 \\
      \hline
    \end{tabular}


    Remarquez que la firme dispose gratuitement d'un alliage ne comportant ni cuivre ni zinc.
    Le but est de trouver les proportions de ces alliages qui doivent
    \^etre m\'elang\'ees  pour produire le nouvel alliage \`a un co\^ut minimum. On vous demande de r\'epondre aux questions suivantes.

    \begin{enumerate}
      \item  Formulez le probl\`eme de la minimisation du co\^ut comme un probl\`eme
        d'optimisation lin\'eaire.

      \item Trouvez la formulation duale de ce probl\`eme. Soit $y_*$ une solution
        optimale du dual. Proposez une interpr\'etation pour les
        diff\'erentes composantes de
        $y_*$. R\'esolvez ce probl\`eme dual et trouvez sa solution $y_*$.
      \item   On suppose que le pourcentage minimum requis de cuivre augmente l\'eg\`erement
        (il passe de 30 $\%$ \`a (30+$\delta$) $\%$ avec $\delta$ petit).
        Comment \'evolue le co\^ut optimal de production du nouvel alliage?
        Soyez aussi pr\'ecis que possible.

      \item Que vaut le co\^ut optimal de production du probl\`eme initial?
    \end{enumerate}




    \begin{solution}
      \nosolution
    \end{solution}

  \item  Un épargnant investit 1000 EUR. Il a le choix entre trois investissements A, B et C. Les résultats attendus et
    garantis pour ces investissements sont les suivants (pour 1 EUR):\\


    \begin{tabular}{ccc}
      & attendu & garanti\\
      A & 1.4 & 0.9\\
      B & 1.2 & 1.2\\
      C & 1.6 & 0.5\\
    \end{tabular}

    \hspace{10mm}

    L'épargnant a promis d'investir au moins 600 EUR en  B et C. Il souhaite en outre un intérêt global
    d'au moins
    $5 \%$ et cherche la répartition de son investissement  qui maximise l'espérance de son gain.

    \begin{enumerate}
      \item Formulez ce problème comme un problème d'optimisation linéaire et résolvez-le. Pour trouver la
        solution vous pouvez, si vous le souhaitez, choisir comme solution de départ celle qui consiste à investir 1000
        EUR dans B.
      \item L'épargnant choisit d'investir \emph{au plus}   1000 EUR. Formulez ce problème comme un problème
        d'optimisation linéaire. La solution optimale que vous obtenez pour cette version modifiée est-elle
        différente de celle obtenue en 1?
      \item Ecrivez le dual du problème obtenu en 1 et proposez une interprétation pour les variables duales
        optimales.
    \end{enumerate}


    \begin{solution}
      \nosolution
    \end{solution}

  \item Jacques choisit un nombre de 1 \`a $m$, son adversaire, Yvan,
    choisit ind\'ependamment de Jacques, un nombre de 1 \`a $n$. Si
    Jacques choisit $i$ et Yvan $j$, Jacques re\c coit $a_{ij}$ d'Yvan.
    Jacques et Yvan appliquent des strat\'egies probabilistes; Jacques
    choisit $i$ avec une probabilit\'e $x_i$  ($x_i \geq 0$ et $\sum_1^m
    x_i =1$) et Yvan choisit $j$ avec une probabilit\'e $y_j$ ($y_j \geq
    0$ et $\sum_1^n y_i =1$).

    \begin{enumerate}
      \item Soit $x$ et $y$ les strat\'egies de Jacques et d'Yvan. Quel
      est le gain moyen de Jacques par partie? \item Jacques divulgue la
        strat\'egie probabiliste qu'il applique. Quelle strat\'egie Yvan
        doit-il appliquer pour maximiser son gain? Formulez ce probl\`eme
      comme un probl\`eme d'optimisation. \item \label{l1} Nous
        consid\'erons maintenant un jeu pr\'ecis. Jacques et Yvan
        choisissent tout les deux un nombre de  1 \`a 3. Le joueur ayant
        choisi le nombre le plus \'elev\'e re\c coit 1 EUR de son
        adversaire, sauf si ce nombre est exactement d'une unit\'e
        sup\'erieur au nombre choisi par l'adversaire, auquel cas, il donne
        3 EUR \`a son adversaire. Lorsque les nombres choisis sont \'egaux,
        les joueurs font match nul et personne ne gagne rien. Jacques
        annonce sa strat\'egie probabiliste: il joue 1, 2 et 3 avec les
        probabilit\'es $0$, $1/2$ et $1/2$. Quelle strat\'egie Yvan doit-il
        choisir pour maximiser son gain et quel est son gain moyen par
      partie? La strat\'egie optimale pour Yvan est-elle unique? \item
        \label{t1} On consid\`ere le jeu d\'ecrit en \ref{l1}. Jacques sait
        que s'il joue suivant la strat\'egie probabilitiste $x$; Yvan
        choisira la strat\'egie probabiliste $y$ qui maximise son gain
        moyen. Sachant cela, quelle strat\'egie Jacques doit-il adopter pour
        maximiser son gain moyen? Ecrivez ce probl\`eme sous forme d'un
        probl\`eme d'optimisation lin\'eaire.

      \item R\'esolvez le probl\`eme formul\'e en
        \ref{t1}. Quel est le gain moyen de Jacques?

    \end{enumerate}

    \begin{solution}
      La théorie des jeux constitue une approche mathématique de problèmes
      de stratégie tels qu'on en trouve en recherche opérationnelle
      et en économie.
      Elle étudie les situations où les choix de deux protagonistes ou
      davantage ont des conséquences pour
      l'un comme pour l'autre (source Wikipédia).

      Le tableau qui contient les indices $a_{ij}$ correspond au tableau
      usuel que l'on retrouve dans l'analyse des probabilités.
      Ce sont toutes les combinaisons possibles dont la somme des probabilités
      associées à chaque couple d'entier vaut 1
      et donc chaque case correspond au gain d'un des protagoniste.
      \begin{enumerate}
        \item Soit $a_{ij}$, le gain réel de Jacques.
          L'espérance de Jacques est de
          $$\sum_{i=1}^{m}x_{i}\sum_{j=1}^{n}y_{j}a_{ij} = y^TAx$$
          où $A$ est la matrice avec $a_{ij}$ à la ligne $i$ et colonne $j$.
        \item Si Yvan veut maximiser son gain,
          il doit minimiser le gain espéré de Jacques, c'est-à-dire,
          \begin{align*}
            \min_y y^TAx\\
            \sum_{j=1}^n y_j & = 1\\
            \leq y_j \leq 1 & j = 1, \dots, n\\
            y & \geq 0.
          \end{align*}
        \item
          On sait par l'inégalité de Cauchy-Schwartz que
          \[ |y^TAx| \leq \|y\|\cdot\|Ax\| \]
          avec égalité lorsque $y$ est parallèle à $Ax$.
          Ici,
          \[ A =
            \begin{pmatrix}
              0 & -3 & 1\\
              3 & 0 & -3\\
              1 & 3 & 0
          \end{pmatrix} \]
          et $x = \begin{pmatrix}0 & 1/2 & 1/2\end{pmatrix}^T$
          donc $Ax = \begin{pmatrix}-1 & -3/2 & 3/2\end{pmatrix}^T$.
          On voit ici directement que la solution optimale est
          $y = \begin{pmatrix}0 & 1 & 0\end{pmatrix}^T$ et qu'elle est
          unique.
        \item On remarque que Yvan choisira toujours de tout le temps jouer
          le nombre qui fait perdre le plus à Jacques.
          Le gain moyen est donc toujours la valeur minimale de $Ax$.
          Il faut donc maximiser $\min Ax$, d'où le problème
          d'optimisation linéaire
          \begin{align*}
            \max_{x,t} t\\
            -a_{*j}x + t & \leq 0 & j = 1, \dots, n\\
            \sum_{i=1}^m x & = 1\\
            x_i & \leq 1 & i = 1, \dots, m\\
            x & \geq 0.
          \end{align*}
        \item La solution optimale est donnée par
        $x = \frac{1}{7}\begin{pmatrix}4 & 0 & 3\end{pmatrix}^T$ et donne
        un gain moyen de $\frac{3}{7}$.
      \end{enumerate}
    \end{solution}

\end{enumerate}
